<!doctype html>
<html>
<head>
    <title>Voting app - List</title>

    <script src="http://localhost:8080/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" charset="utf-8">

    jQuery(document).ready(function(){
        var log_chat_message = function(message){
            var li = jQuery('<li />').text(message);
            jQuery('#chat_log').append(li);
        }

        var socket = io.connect('http://localhost:8080');//cambiar puerto

        socket.on('exit', function  (data) {
            log_chat_message(data.message);
        });
        
        socket.on('outcoming_vote', function  (data) {

            log_chat_message(data.message);
            jQuery("#result_a").text(data.a);
            jQuery("#result_b").text(data.b);
        });

        jQuery("#vote_A").click(function(event){
            socket.emit('incoming_vote', {option: "a", id: "<%= id %>"});
        });
        jQuery("#vote_B").click(function(event){
            socket.emit('incoming_vote', {option: "b", id: "<%= id %>"});
        });
    });
    </script>

    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">


</head>
<body>
<div class="container">

    <div class="page-header text-center">
        <h1><span class="fa fa-ambulance"></span> VOTACION</h1>
    </div>

    <div class="row">

        <p>Bienvenido <%= user.local.email %> - <a href="/logout" class="btn btn-default btn-sm">Logout</a></p>

        <!-- LOCAL INFORMATION -->
        <div class="col-sm-12">
            <div class="well">
                <a href='/voting_list'  class="btn btn-default btn-sm">VER VOTACIONES</a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12">
            <h3><%= title %></h3>
            <p><%= comment %></p>
            <table>
                <tr>
                    <th>Opción A</th>
                    <th>Opción B</th>
                </tr>
                <tr>
                    <td id="result_a"><%= result_a %></td>
                    <td id="result_b"><%= result_b %></td>
                </tr>
                <tr>
                    <td><button id="vote_A">Vote</button></td>
                    <td><button id="vote_B">Vote</button></td>
                </tr>    
            </table>
        </div>
    </div>

</div>
</body>
</html>